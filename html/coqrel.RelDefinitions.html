<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>coqrel.RelDefinitions</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library coqrel.RelDefinitions</h1>

<div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#"><span class="id" type="library">Coq.Program.Basics</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.Morphisms.html#"><span class="id" type="library">Coq.Classes.Morphisms</span></a>.<br/>
<span class="id" type="keyword">Require</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Setoids.Setoid.html#"><span class="id" type="library">Setoid</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <a class="idref" href="coqrel.Delay.html#"><span class="id" type="library">Delay</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab47"></a><h1 class="section">Prerequisites</h1>

<div class="paragraph"> </div>

 Some instances that would normally cause loops can be used
  nontheless if we insist that some parameters cannot be existential
  variables. One way to do this is to use this guard class, similar in
  spirit to <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#Unconvertible"><span class="id" type="record">Unconvertible</span></a></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="NotEvar"><span class="id" type="record">NotEvar</span></a> {<span class="id" type="var">A</span>} (<span class="id" type="var">x</span>: <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a>).<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 1 (<a class="idref" href="coqrel.RelDefinitions.html#NotEvar"><span class="id" type="class">NotEvar</span></a> ?<span class="id" type="var">x</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="var">not_evar</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">constructor</span> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
This version of <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#Unconvertible"><span class="id" type="record">Unconvertible</span></a></span> does not assume that <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#a"><span class="id" type="variable">a</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#b"><span class="id" type="variable">b</span></a></span>
  have convertible types. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="Unconvertible"><span class="id" type="record">Unconvertible</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">a</span>: <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a>) (<span class="id" type="var">b</span>: <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) := <a name="unconvertible"><span class="id" type="projection">unconvertible</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">unconvertible</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" type="var">unify</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">with</span> <span class="id" type="var">typeclass_instances</span>; <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="tactic">exact</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#tt"><span class="id" type="constructor">tt</span></a> ].<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 1 (<a class="idref" href="coqrel.RelDefinitions.html#Unconvertible"><span class="id" type="class">Unconvertible</span></a> ?<span class="id" type="var">a</span> ?<span class="id" type="var">b</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="var">unconvertible</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
Sometimes we may want to introduce an auxiliary variable to help
  with unification. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="Convertible"><span class="id" type="record">Convertible</span></a> {<span class="id" type="var">A</span>} (<span class="id" type="var">x</span> <span class="id" type="var">y</span>: <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a>) :=<br/>
&nbsp;&nbsp;<a name="convertible"><span class="id" type="projection">convertible</span></a>: <a class="idref" href="coqrel.RelDefinitions.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y"><span class="id" type="variable">y</span></a>.<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 1 (<a class="idref" href="coqrel.RelDefinitions.html#Convertible"><span class="id" type="class">Convertible</span></a> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#eq_refl"><span class="id" type="constructor">eq_refl</span></a> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab48"></a><h1 class="section">Relations</h1>

<div class="paragraph"> </div>

 The constructions in <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Relations.Relation_Definitions.html#"><span class="id" type="library">Coq.Relations.Relation_Definitions</span></a></span> are only
  concerned with relations within a single type, so that <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Relations.Relation_Definitions.html#relation"><span class="id" type="definition">relation</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span>
  is defined as <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>. We will need more general
  relations, and so I define <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#B"><span class="id" type="variable">B</span></a></span> as <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#B"><span class="id" type="variable">B</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Prop</span></span>. 
<div class="paragraph"> </div>

 When we move to a version of Coq with universe polymorphism, we
  can make this a <span class="inlinecode"><span class="id" type="var">Polymorphic</span></span> <span class="inlinecode"><span class="id" type="keyword">Definition</span></span>. In the meantime, we need
  to use a notation so that universes levels are instantiated at every
  use site. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Notation</span> <a name="rel"><span class="id" type="abbreviation">rel</span></a> := (<span class="id" type="keyword">fun</span> <span class="id" type="var">A1</span> <span class="id" type="var">A2</span> ⇒ <a class="idref" href="coqrel.RelDefinitions.html#A1"><span class="id" type="variable">A1</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#A2"><span class="id" type="variable">A2</span></a> → <span class="id" type="keyword">Prop</span>).<br/>

<br/>
</div>

<div class="doc">
Note that the status of <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span> as a notation, rather than an actual
  definition, also prevents us from binding it to a <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span>
  scope. As a workaround, we open it as a global scope; in most places
  the <span class="inlinecode"><span class="id" type="var">type</span></span> scope will override it as required. However this is an
  imperfect solutions, and means we must scope type explicitely here
  and there. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Delimit</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">rel_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">rel</span>.<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">rel_scope</span>.<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">type_scope</span>.<br/>

<br/>
</div>

<div class="doc">
Make sure that the existing definitions based on
  <span class="inlinecode"><span class="id" type="var">Relation_Definitions.relation</span></span> use our <span class="inlinecode"><span class="id" type="var">rel_scope</span></span> as well. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Bind</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">rel_scope</span> <span class="id" type="keyword">with</span> <span class="id" type="var">Relation_Definitions.relation</span>.<br/>

<br/>
</div>

<div class="doc">
For Coq 8.4 we need to rescope the arguments for common
  definitions; in 8.5 it seems it is done automatically. 
</div>
<div class="code">

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#Reflexive"><span class="id" type="class">Reflexive</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span>} <span class="id" type="var">R</span>%<span class="id" type="var">rel</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#Transitive"><span class="id" type="class">Transitive</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span>} <span class="id" type="var">R</span>%<span class="id" type="var">rel</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#Symmetric"><span class="id" type="class">Symmetric</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span>} <span class="id" type="var">R</span>%<span class="id" type="var">rel</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span>} <span class="id" type="var">R</span>%<span class="id" type="var">rel</span>.<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#Equivalence"><span class="id" type="class">Equivalence</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span>} <span class="id" type="var">R</span>%<span class="id" type="var">rel</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab49"></a><h2 class="section">Proof step</h2>

<div class="paragraph"> </div>

 This is a catch-all class for any applicable strategy allowing us
  to make progress towards solving a relational goal. The proposition
  <span class="inlinecode"><a class="idref" href="coqrel.Transport.html#P"><span class="id" type="variable">P</span></a></span> should encode the new subgoals, in the format expected by
  <span class="inlinecode"><span class="id" type="var">Delay.split_conjunction</span></span>, and is decomposed accordingly in the
  <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rstep"><span class="id" type="projection">rstep</span></a></span> tactic.

<div class="paragraph"> </div>

  At the moment, the following priorities are used for our different
  <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="record">RStep</span></a></span> instances. Generally speaking, the most specific, quick
  tactics should be registered with higher priority (lower numbers),
  and the more general, slow tactics that are likely to instantiate
  evars incorrectly or spawn them too early should have lower priority
  (higher numbers):

<div class="paragraph"> </div>

<ul class="doclist">
<li> 10 <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RIntro"><span class="id" type="record">RIntro</span></a></span>

</li>
<li> 30 <span class="inlinecode"><span class="id" type="var">preorder</span></span>

</li>
<li> 40 <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="record">RDestruct</span></a></span>

</li>
<li> 50 <span class="inlinecode"><a class="idref" href="coqrel.Monotonicity.html#Monotonicity"><span class="id" type="record">Monotonicity</span></a></span> (includes <span class="inlinecode"><span class="id" type="var">Reflexivity</span></span> -- we may want to split)

</li>
<li> 70 <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RExists"><span class="id" type="record">RExists</span></a></span> 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="RStep"><span class="id" type="record">RStep</span></a> (<span class="id" type="var">P</span> <span class="id" type="var">Q</span>: <span class="id" type="keyword">Prop</span>) :=<br/>
&nbsp;&nbsp;<a name="rstep"><span class="id" type="projection">rstep</span></a>: <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rstep</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">lazymatch</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" type="var">Q</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="coqrel.RelDefinitions.html#rstep"><span class="id" type="definition">rstep</span></a> (<span class="id" type="var">Q</span> := <span class="id" type="var">Q</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Delay.split_conjunction</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab50"></a><h2 class="section">Proof automation</h2>

<div class="paragraph"> </div>

 The following class solves the goal <span class="inlinecode"><a class="idref" href="coqrel.Transport.html#Q"><span class="id" type="variable">Q</span></a></span> automatically. The
  typeclass resolution process allows for backtracking, trying every
  possible <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="record">RStep</span></a></span> at a given time. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="RAuto"><span class="id" type="record">RAuto</span></a> (<span class="id" type="var">Q</span>: <span class="id" type="keyword">Prop</span>) :=<br/>
&nbsp;&nbsp;<a name="rauto"><span class="id" type="projection">rauto</span></a> : <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rauto</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">lazymatch</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" type="var">Q</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="coqrel.RelDefinitions.html#rauto"><span class="id" type="definition">rauto</span></a> (<span class="id" type="var">Q</span> := <span class="id" type="var">Q</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Delay.split_conjunction</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
After applying each step, we need to decompose the premise into
  individual subgoals, wrapping each one into a new <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RAuto"><span class="id" type="record">RAuto</span></a></span> goal so
  that the process continues. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="RAutoSubgoals"><span class="id" type="record">RAutoSubgoals</span></a> (<span class="id" type="var">P</span>: <span class="id" type="keyword">Prop</span>) :=<br/>
&nbsp;&nbsp;<a name="rauto_subgoals"><span class="id" type="projection">rauto_subgoals</span></a> : <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a>.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="rauto_rstep"><span class="id" type="instance">rauto_rstep</span></a> <span class="id" type="var">P</span> <span class="id" type="var">Q</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="class">RStep</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RAutoSubgoals"><span class="id" type="class">RAutoSubgoals</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RAuto"><span class="id" type="class">RAuto</span></a> <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rauto_split</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">red</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">Delay.split_conjunction</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">lazymatch</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" type="var">Q</span> ⇒ <span class="id" type="tactic">change</span> (<a class="idref" href="coqrel.RelDefinitions.html#RAuto"><span class="id" type="class">RAuto</span></a> <span class="id" type="var">Q</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 1 (<a class="idref" href="coqrel.RelDefinitions.html#RAutoSubgoals"><span class="id" type="class">RAutoSubgoals</span></a> <span class="id" type="var">_</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="var">rauto_split</span> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rauto"><span class="id" type="projection">rauto</span></a></span> is run under the <span class="inlinecode"><span class="id" type="var">delayed</span></span> tactical and we don't know
  how to make progress, bail out. Note that this will inhibit
  backtracking. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Hint Extern</span> 1000 (<a class="idref" href="coqrel.RelDefinitions.html#RAuto"><span class="id" type="class">RAuto</span></a> <span class="id" type="var">_</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="tactic">red</span>; <span class="id" type="tactic">solve</span> [ <span class="id" type="var">delay</span> ] : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab51"></a><h2 class="section">Introduction rules</h2>

<div class="paragraph"> </div>

 In effect, <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RIntro"><span class="id" type="record">RIntro</span></a></span> is pretty much identical to <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="record">RStep</span></a></span>, but we
  like to separate introduction rules and the <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rintro"><span class="id" type="projection">rintro</span></a></span> tactic. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="RIntro"><span class="id" type="record">RIntro</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">P</span>: <span class="id" type="keyword">Prop</span>) (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) (<span class="id" type="var">m</span>: <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a>) (<span class="id" type="var">n</span>: <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>): <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="rintro"><span class="id" type="projection">rintro</span></a>: <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="coqrel.RelDefinitions.html#RIntro"><span class="id" type="class">RIntro</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span> <span class="id" type="var">B</span>%<span class="id" type="var">type</span>} <span class="id" type="var">P</span>%<span class="id" type="var">type</span> <span class="id" type="var">R</span>%<span class="id" type="var">rel</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rintro</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">lazymatch</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" type="var">R</span> ?<span class="id" type="var">m</span> ?<span class="id" type="var">n</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="coqrel.RelDefinitions.html#rintro"><span class="id" type="definition">rintro</span></a> (<span class="id" type="var">R</span>:=<span class="id" type="var">R</span>) (<span class="id" type="var">m</span>:=<span class="id" type="var">m</span>) (<span class="id" type="var">n</span>:=<span class="id" type="var">n</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Delay.split_conjunction</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="rintro_rstep"><span class="id" type="instance">rintro_rstep</span></a>:<br/>
&nbsp;&nbsp;<span class="id" type="keyword">∀</span> `(<a class="idref" href="coqrel.RelDefinitions.html#RIntro"><span class="id" type="class">RIntro</span></a>), <a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="class">RStep</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>) | 10.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Most introduction rules are entierly reversible. For instance,
  suppose we use the introduction rule for <span class="inlinecode">++&gt;</span> on a goal of the form
  <span class="inlinecode">(<a class="idref" href="coqrel.LogicalRelationsTests.html#R1"><span class="id" type="variable">R1</span></a></span> <span class="inlinecode">++&gt;</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R2"><span class="id" type="variable">R2</span></a>)</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span>, to obtain <span class="inlinecode"><span class="id" type="var">Hxy</span>:</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R1"><span class="id" type="variable">R1</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x"><span class="id" type="variable">x</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#y"><span class="id" type="variable">y</span></a></span> <span class="inlinecode">|-</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R2"><span class="id" type="variable">R2</span></a></span> <span class="inlinecode">(<a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x"><span class="id" type="variable">x</span></a>)</span> <span class="inlinecode">(<a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#y"><span class="id" type="variable">y</span></a>)</span>. If at
  a later stage we manage to prove our old goal <span class="inlinecode"><span class="id" type="var">Hfg</span>:</span> <span class="inlinecode">(<a class="idref" href="coqrel.LogicalRelationsTests.html#R1"><span class="id" type="variable">R1</span></a></span> <span class="inlinecode">++&gt;</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R2"><span class="id" type="variable">R2</span></a>)</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span>,
  we can always use the elimination rule for <span class="inlinecode">++&gt;</span> in conjunction with
  the two hypotheses to prove <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R2"><span class="id" type="variable">R2</span></a></span> <span class="inlinecode">(<a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x"><span class="id" type="variable">x</span></a>)</span> <span class="inlinecode">(<a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#y"><span class="id" type="variable">y</span></a>)</span>.

<div class="paragraph"> </div>

  On the other hand, whenever a new existential variable is involved,
  this reversibility is lost: the time of introduction of the evar
  determines what a valid instantiation is, and there is no way to go
  back if we want to use components introduced later, say by
  destructing one of the hypotheses.

<div class="paragraph"> </div>

  For this reason, we want such introduction rules to be used only as
  a last resort, and segregate them as instances of the following
  class rather than <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RIntro"><span class="id" type="record">RIntro</span></a></span>. Moreover, to make sure that we don't
  leave the user in a dead-end, we only use it if we can immediately
  solve the resulting subgoal. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="RExists"><span class="id" type="record">RExists</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">P</span>: <span class="id" type="keyword">Prop</span>) (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) (<span class="id" type="var">m</span>: <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a>) (<span class="id" type="var">n</span>: <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>): <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="rexists"><span class="id" type="projection">rexists</span></a>: <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="coqrel.RelDefinitions.html#RExists"><span class="id" type="class">RExists</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span> <span class="id" type="var">B</span>%<span class="id" type="var">type</span>} <span class="id" type="var">P</span>%<span class="id" type="var">type</span> <span class="id" type="var">R</span>%<span class="id" type="var">rel</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">reexists</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">lazymatch</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" type="var">R</span> ?<span class="id" type="var">m</span> ?<span class="id" type="var">n</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="coqrel.RelDefinitions.html#rexists"><span class="id" type="definition">rexists</span></a> (<span class="id" type="var">R</span>:=<span class="id" type="var">R</span>) (<span class="id" type="var">m</span>:=<span class="id" type="var">m</span>) (<span class="id" type="var">n</span>:=<span class="id" type="var">n</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Delay.split_conjunction</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="rexists_rstep"><span class="id" type="instance">rexists_rstep</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} <span class="id" type="var">P</span> <span class="id" type="var">R</span> (<span class="id" type="var">m</span>:<a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a>) (<span class="id" type="var">n</span>:<a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RExists"><span class="id" type="class">RExists</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.Delay.html#NonDelayed"><span class="id" type="class">NonDelayed</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#RAutoSubgoals"><span class="id" type="class">RAutoSubgoals</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a>) →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="class">RStep</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>) | 70.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab52"></a><h2 class="section">Using relations</h2>

<div class="paragraph"> </div>

 As we extend our relations language with new relators, we need to
  be able to extend the ways in which corresponding relational
  properties can be applied to a given goal. The following type class
  expresses that the relational property <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#m"><span class="id" type="variable">m</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#n"><span class="id" type="variable">n</span></a></span> can be applied to a
  goal of type <span class="inlinecode"><a class="idref" href="coqrel.Transport.html#Q"><span class="id" type="variable">Q</span></a></span>, generating the subgoal <span class="inlinecode"><a class="idref" href="coqrel.Transport.html#P"><span class="id" type="variable">P</span></a></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="RElim"><span class="id" type="record">RElim</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) (<span class="id" type="var">m</span>: <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a>) (<span class="id" type="var">n</span>: <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) (<span class="id" type="var">P</span> <span class="id" type="var">Q</span>: <span class="id" type="keyword">Prop</span>): <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="relim"><span class="id" type="projection">relim</span></a>: <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span> <span class="id" type="var">B</span>%<span class="id" type="var">type</span>} <span class="id" type="var">R</span>%<span class="id" type="var">rel</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="var">P</span>%<span class="id" type="var">type</span> <span class="id" type="var">Q</span>%<span class="id" type="var">type</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">relim</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">lazymatch</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" type="var">Q</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="coqrel.RelDefinitions.html#relim"><span class="id" type="definition">relim</span></a> (<span class="id" type="var">Q</span>:=<span class="id" type="var">Q</span>) <span class="id" type="var">H</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The resolution process is directed by the syntax of <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span>. We define
  an instance for each function relator. The base case simply uses the
  relational property as-is. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="relim_base"><span class="id" type="instance">relim_base</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) <span class="id" type="var">m</span> <span class="id" type="var">n</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab53"></a><h2 class="section">Destructing relational hypotheses</h2>

<div class="paragraph"> </div>

 To make progress when the goal relates two pattern matching
  constructions, we need to show that the two matched terms are
  related, then destruct that hypothesis in a such a way that the two
  terms reduce to constructors.

<div class="paragraph"> </div>

  For most relators of inductive types, the constructors of the
  relator will simply follow the constructors of the corresponding
  type, so that destructing the relational hypothesis in the usual way
  will produce the desired outcome. However, sometimes it is more
  convenient to define such relators in a different way (see for
  instance <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#prod_rel"><span class="id" type="definition">prod_rel</span></a></span>). In that case, we can use the following
  typeclass to specify an alternative way to destruct corresponding
  hypotheses.

<div class="paragraph"> </div>

  An instance of <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="record">RDestruct</span></a></span> is somewhat similar to a stylized
  induction principle. <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#T"><span class="id" type="variable">T</span></a></span> expands to a conjunction of subgoals in the
  format expected by <span class="inlinecode"><span class="id" type="var">Delay.split_conjunction</span></span>. For instance, the
  induction principle for <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#sum_rel"><span class="id" type="inductive">sum_rel</span></a></span> is:

<div class="paragraph"> </div>

  <tt>&lt;
  sum_rel_ind:
    forall ...,
      (forall a1 a2, RA a1 a2 -&gt; P (inl a1) (inl a2)) -&gt;
      (forall b1 b2, RB b1 b2 -&gt; P (inr b1) (inr b2)) -&gt;
      (forall p1 p2, (RA + RB) p1 p2 -&gt; P p1 p2)
  </tt>&gt;

<div class="paragraph"> </div>

  A corresponding instance of <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="record">RDestruct</span></a></span> would be:

<div class="paragraph"> </div>

  <tt>&lt;
  sum_rdestruct:
    RDestruct
      (sum_rel RA RB)
      (fun P =&gt;
        (forall a1 a2, RA a1 a2 -&gt; P (inl a1) (inl a2)) /\
        (forall b1 b2, RB b1 b2 -&gt; P (inr b1) (inr b2)))
  </tt>&gt;

<div class="paragraph"> </div>

  In the case of <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#sum_rel"><span class="id" type="inductive">sum_rel</span></a></span> however, which is defined as an inductive
  type with similar structure to <span class="inlinecode"><span class="id" type="var">sum</span></span>, we can rely on the default
  instance of <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="record">RDestruct</span></a></span>, which simply uses the <span class="inlinecode"><span class="id" type="tactic">destruct</span></span> tactic. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="RDestruct"><span class="id" type="record">RDestruct</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>: <span class="id" type="keyword">Type</span>} (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) (<span class="id" type="var">T</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a> → <span class="id" type="keyword">Prop</span>) :=<br/>
&nbsp;&nbsp;<a name="rdestruct"><span class="id" type="projection">rdestruct</span></a> <span class="id" type="var">m</span> <span class="id" type="var">n</span>: <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a> → <span class="id" type="keyword">∀</span> <span class="id" type="var">P</span>, <a class="idref" href="coqrel.RelDefinitions.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rdestruct</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">lazymatch</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">R</span> ?<span class="id" type="var">m</span> ?<span class="id" type="var">n</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">not_evar</span> <span class="id" type="var">R</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pattern</span> <span class="id" type="var">m</span>, <span class="id" type="var">n</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="coqrel.RelDefinitions.html#rdestruct"><span class="id" type="definition">rdestruct</span></a> (<span class="id" type="var">R</span>:=<span class="id" type="var">R</span>) <span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="var">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Delay.split_conjunction</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">default_rdestruct</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">m</span> := <span class="id" type="tactic">fresh</span> "m" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <span class="id" type="tactic">fresh</span> "n" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">Hmn</span> := <span class="id" type="tactic">fresh</span> "H" <span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">P</span> := <span class="id" type="tactic">fresh</span> "P" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="var">Hmn</span> <span class="id" type="var">P</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">revert</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="var">Hmn</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">delayed_conjunction</span> (<span class="id" type="tactic">intros</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="var">Hmn</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">Hmn</span>; <span class="id" type="var">delay</span>);<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pattern</span> <span class="id" type="var">P</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eexact</span> <span class="id" type="var">H</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 100 (<a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="class">RDestruct</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="var">default_rdestruct</span> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
To use <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="record">RDestruct</span></a></span> instances to reduce a goal involving pattern
  matching <span class="inlinecode"><span class="id" type="var">G</span></span> := <span class="inlinecode"><span class="id" type="var">_</span></span> <span class="inlinecode">(<span class="id" type="keyword">match</span></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#m"><span class="id" type="variable">m</span></a></span> <span class="inlinecode"><span class="id" type="keyword">with</span></span> <span class="inlinecode"><span class="id" type="var">_</span></span> <span class="inlinecode"><span class="id" type="keyword">end</span>)</span> <span class="inlinecode">(<span class="id" type="keyword">match</span></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#n"><span class="id" type="variable">n</span></a></span> <span class="inlinecode"><span class="id" type="keyword">with</span></span> <span class="inlinecode"><span class="id" type="var">_</span></span> <span class="inlinecode"><span class="id" type="keyword">end</span>)</span>, we
  need to establish that <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#m"><span class="id" type="variable">m</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#n"><span class="id" type="variable">n</span></a></span> are related by some relation <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span>,
  then locate an instance of <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="record">RDestruct</span></a></span> that corresponds to <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span>. It
  is essential that this happens in one step. At some point, I tried
  to split the process in two different <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="record">RStep</span></a></span>s, so that the user
  could control the resolution of the <span class="inlinecode">?<a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#m"><span class="id" type="variable">m</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#n"><span class="id" type="variable">n</span></a></span> subgoal. However, in
  situation where <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="record">RDestruct</span></a></span> is not the right strategy, this may
  push a <span class="inlinecode"><span class="id" type="var">delayed</span></span> <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rauto"><span class="id" type="projection">rauto</span></a></span> into a dead end. Thankfully, now we can use
  the <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RAuto"><span class="id" type="record">RAuto</span></a></span> typeclass to solve the <span class="inlinecode">?<a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#m"><span class="id" type="variable">m</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#n"><span class="id" type="variable">n</span></a></span> subgoal in one swoop. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="rdestruct_rstep"><span class="id" type="lemma">rdestruct_rstep</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} <span class="id" type="var">m</span> <span class="id" type="var">n</span> (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) <span class="id" type="var">P</span> <span class="id" type="var">Q</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RAuto"><span class="id" type="class">RAuto</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>) →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="class">RDestruct</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hmn</span> <span class="id" type="var">HR</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">use_rdestruct_rstep</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pattern</span> <span class="id" type="var">m</span>, <span class="id" type="var">n</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> (<a class="idref" href="coqrel.RelDefinitions.html#rdestruct_rstep"><span class="id" type="lemma">rdestruct_rstep</span></a> <span class="id" type="var">m</span> <span class="id" type="var">n</span>);<br/>
&nbsp;&nbsp;[ .. | <span class="id" type="tactic">eexact</span> <span class="id" type="var">H</span>].<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 40 (<a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="class">RStep</span></a> <span class="id" type="var">_</span> (<span class="id" type="var">_</span> (<span class="id" type="keyword">match</span> ?<span class="id" type="var">m</span> <span class="id" type="keyword">with</span> <span class="id" type="var">_</span>⇒<span class="id" type="var">_</span> <span class="id" type="keyword">end</span>) (<span class="id" type="keyword">match</span> ?<span class="id" type="var">n</span> <span class="id" type="keyword">with</span> <span class="id" type="var">_</span>⇒<span class="id" type="var">_</span> <span class="id" type="keyword">end</span>))) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="var">use_rdestruct_rstep</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
In the special case where the terms matched on the left- and
  right-hand sides are identical, we want to destruct that term
  instead. At the moment, it's unclear to me whether this could be
  formulated as an <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RDestruct"><span class="id" type="record">RDestruct</span></a></span> instance for <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a></span>, or whether the
  process above could subsume this (we should conduct experiments with
  real code at some point). 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_rstep</span> <span class="id" type="var">m</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="var">m</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">delayed_conjunction</span> (<span class="id" type="tactic">intros</span> <span class="id" type="var">n</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">n</span>; <span class="id" type="var">delay</span>);<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eexact</span> <span class="id" type="var">H</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 39 (<a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="class">RStep</span></a> <span class="id" type="var">_</span> (<span class="id" type="var">_</span> (<span class="id" type="keyword">match</span> ?<span class="id" type="var">m</span> <span class="id" type="keyword">with</span> <span class="id" type="var">_</span>⇒<span class="id" type="var">_</span> <span class="id" type="keyword">end</span>) (<span class="id" type="keyword">match</span> ?<span class="id" type="var">m</span> <span class="id" type="keyword">with</span> <span class="id" type="var">_</span>⇒<span class="id" type="var">_</span> <span class="id" type="keyword">end</span>))) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="var">destruct_rstep</span> <span class="id" type="var">m</span> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab54"></a><h2 class="section">Monotonicity properties</h2>

<div class="paragraph"> </div>

 We use the class <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="record">Related</span></a></span> for the user to declare monotonicity
  properties. This is a generalization of <span class="inlinecode"><span class="id" type="var">Morphisms.Proper</span></span> from the
  Coq standard library: although we expect that most of the time the
  left- and right-hand side terms will be identical, they could be
  slightly different partial applications of the same function.

<div class="paragraph"> </div>

  Usually the differing arguments will be implicit, so that the user
  can still rely on the <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#Monotonic"><span class="id" type="abbreviation">Monotonic</span></a></span> notation below. Occasionally, you
  may need to spell out the two different terms and use the actual
  class instead.

<div class="paragraph"> </div>

  Note that the argument order below eschews the precedent of <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#Proper"><span class="id" type="abbreviation">Proper</span></a></span>,
  which has the relation first, followed by the proper element. This is
  deliberate: we want the type parameters <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#B"><span class="id" type="variable">B</span></a></span> to be unified in
  priority against the type of <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span>, rather than that of <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span>.
  In particular, the relator <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a></span> yields an eta-expanded type
  of the form <span class="inlinecode">(<span class="id" type="keyword">fun</span></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x"><span class="id" type="variable">x</span></a></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#T"><span class="id" type="variable">T</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x"><span class="id" type="variable">x</span></a>)</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x"><span class="id" type="variable">x</span></a></span> for its arguments. When <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#B"><span class="id" type="variable">B</span></a></span>
  take this peculiar form, instances declared using <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a></span>
  become unusable (I assume because no second-order unification is
  performed when looking up the typeclass instance database). By
  contrast the type of <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span> is much more likely to be in a
  "reasonable" form. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Class</span> <a name="Related"><span class="id" type="record">Related</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">f</span>: <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a>) (<span class="id" type="var">g</span>: <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) :=<br/>
&nbsp;&nbsp;<a name="related"><span class="id" type="projection">related</span></a>: <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="class">Related</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span> <span class="id" type="var">B</span>%<span class="id" type="var">type</span>} <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">R</span>%<span class="id" type="var">rel</span>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="::'@'_'Monotonic'_x_x_x"><span class="id" type="notation">"</span></a>'@' 'Monotonic' T m R" := (@<a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="class">Related</span></a> <span class="id" type="var">T</span> <span class="id" type="var">T</span> <span class="id" type="var">m</span> <span class="id" type="var">m</span> <span class="id" type="var">R</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 10, <span class="id" type="var">T</span> <span class="id" type="tactic">at</span> <span class="id" type="var">next</span> <span class="id" type="keyword">level</span>, <span class="id" type="var">R</span> <span class="id" type="tactic">at</span> <span class="id" type="var">next</span> <span class="id" type="keyword">level</span>, <span class="id" type="var">m</span> <span class="id" type="tactic">at</span> <span class="id" type="var">next</span> <span class="id" type="keyword">level</span>).<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="Monotonic"><span class="id" type="abbreviation">Monotonic</span></a> <span class="id" type="var">m</span> <span class="id" type="var">R</span> := (<a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="class">Related</span></a> <span class="id" type="var">m</span> <span class="id" type="var">m</span> <span class="id" type="var">R</span>).<br/>

<br/>
</div>

<div class="doc">
Another issue related to unification of type arguments: because
  <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span> is not a proper definition, sometimes Coq beta-reduces
  expressions spontaneously which interferes with typeclass
  resolution. As a result we need the following hint for
  <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#arrow_subrel"><span class="id" type="instance">arrow_subrel</span></a></span> below to be used by the <span class="inlinecode"><a class="idref" href="coqrel.Monotonicity.html#monotonicity"><span class="id" type="projection">monotonicity</span></a></span> tactic. When
  we upgrade to Coq 8.5 and make <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span> a universe-polymorphic
  definition instead of a notation, we can drop this. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Hint Extern</span> 50 (<a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="class">Related</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="tactic">progress</span> <span class="id" type="tactic">cbv</span> <span class="id" type="keyword">beta</span> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
For the sake of backwards compatibility, we override
  <span class="inlinecode"><span class="id" type="var">Morphisms.Proper</span></span> with the following notation. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Notation</span> <a name="::'@'_'Proper'_x_x_x"><span class="id" type="notation">"</span></a>'@' 'Proper' T R m" := (<a class="idref" href="coqrel.RelDefinitions.html#::'@'_'Monotonic'_x_x_x"><span class="id" type="notation">@</span></a><a class="idref" href="coqrel.RelDefinitions.html#::'@'_'Monotonic'_x_x_x"><span class="id" type="notation">Monotonic</span></a> <span class="id" type="var">T</span> <span class="id" type="var">m</span> <span class="id" type="var">R</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 10, <span class="id" type="var">T</span> <span class="id" type="tactic">at</span> <span class="id" type="var">next</span> <span class="id" type="keyword">level</span>, <span class="id" type="var">R</span> <span class="id" type="tactic">at</span> <span class="id" type="var">next</span> <span class="id" type="keyword">level</span>, <span class="id" type="var">m</span> <span class="id" type="tactic">at</span> <span class="id" type="var">next</span> <span class="id" type="keyword">level</span>, <span class="id" type="var">only</span> <span class="id" type="var">parsing</span>).<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="Proper"><span class="id" type="abbreviation">Proper</span></a> <span class="id" type="var">R</span> <span class="id" type="var">m</span> := (<a class="idref" href="coqrel.RelDefinitions.html#Monotonic"><span class="id" type="abbreviation">Monotonic</span></a> <span class="id" type="var">m</span> <span class="id" type="var">R</span>) (<span class="id" type="var">only</span> <span class="id" type="var">parsing</span>).<br/>

<br/>
</div>

<div class="doc">
We provide a <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="record">RStep</span></a></span> instance for unfolding <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="record">Related</span></a></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="unfold_monotonic_rstep"><span class="id" type="lemma">unfold_monotonic_rstep</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) <span class="id" type="var">m</span> <span class="id" type="var">n</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="class">RStep</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="class">Related</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 1 (<a class="idref" href="coqrel.RelDefinitions.html#RStep"><span class="id" type="class">RStep</span></a> <span class="id" type="var">_</span> (<a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="class">Related</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>)) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="coqrel.RelDefinitions.html#unfold_monotonic_rstep"><span class="id" type="lemma">unfold_monotonic_rstep</span></a> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab55"></a><h2 class="section">Order on relations</h2>

<div class="paragraph"> </div>

 This is our generalization of <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#subrelation"><span class="id" type="class">subrelation</span></a></span>. Like the original it
  constitutes a preorder, and the union and intersection of relations
  are the corresponding join and meet. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="subrel"><span class="id" type="definition">subrel</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="coqrel.RelDefinitions.html#R1"><span class="id" type="variable">R1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#R2"><span class="id" type="variable">R2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y"><span class="id" type="variable">y</span></a>.<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a> {<span class="id" type="var">A</span>%<span class="id" type="var">type</span> <span class="id" type="var">B</span>%<span class="id" type="var">type</span>} <span class="id" type="var">R1</span>%<span class="id" type="var">rel</span> <span class="id" type="var">R2</span>%<span class="id" type="var">rel</span>.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="subrel_preorder"><span class="id" type="instance">subrel_preorder</span></a> <span class="id" type="var">A</span> <span class="id" type="var">B</span>:<br/>
&nbsp;&nbsp;@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#PreOrder"><span class="id" type="class">PreOrder</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Instance</span> <a name="subrel_refl"><span class="id" type="instance">subrel_refl</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="class">Related</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="eq_subrel"><span class="id" type="instance">eq_subrel</span></a> {<span class="id" type="var">A</span>} (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#Reflexive"><span class="id" type="class">Reflexive</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#Related"><span class="id" type="class">Related</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#eq"><span class="id" type="inductive">eq</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">HR</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Instance</span> <a name="subrel_impl_relim"><span class="id" type="instance">subrel_impl_relim</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">R1</span> <span class="id" type="var">R2</span> : <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) <span class="id" type="var">x1</span> <span class="id" type="var">x2</span> <span class="id" type="var">y1</span> <span class="id" type="var">y2</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#impl"><span class="id" type="definition">impl</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#R1"><span class="id" type="variable">R1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#x1"><span class="id" type="variable">x1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y1"><span class="id" type="variable">y1</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#R2"><span class="id" type="variable">R2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#x2"><span class="id" type="variable">x2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y2"><span class="id" type="variable">y2</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> <a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R1"><span class="id" type="variable">R1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R2"><span class="id" type="variable">R2</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#x1"><span class="id" type="variable">x1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="coqrel.RelDefinitions.html#x2"><span class="id" type="variable">x2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y1"><span class="id" type="variable">y1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y2"><span class="id" type="variable">y2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">cbv</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab56"></a><h1 class="section">Core relators</h1>

<div class="paragraph"> </div>

 First, we introduce the core relators necessary for everything
  else, namely those for function types. The next section provides a
  more comprehensive library which covers many of the basic inductive
  type constructors as well. 
<div class="paragraph"> </div>

<a name="lab57"></a><h3 class="section">Non-dependent function types</h3>

<div class="paragraph"> </div>

 First, I define relators for non-dependent functions. This
  generalizes <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.Morphisms.html#respectful"><span class="id" type="definition">respectful</span></a></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="arrow_rel"><span class="id" type="definition">arrow_rel</span></a> {<span class="id" type="var">A1</span> <span class="id" type="var">A2</span> <span class="id" type="var">B1</span> <span class="id" type="var">B2</span>}:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A2"><span class="id" type="variable">A2</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B1"><span class="id" type="variable">B1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B2"><span class="id" type="variable">B2</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#A1"><span class="id" type="variable">A1</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#B1"><span class="id" type="variable">B1</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#A2"><span class="id" type="variable">A2</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#B2"><span class="id" type="variable">B2</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">RA</span> <span class="id" type="var">RB</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span> ⇒ <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="coqrel.RelDefinitions.html#RA"><span class="id" type="variable">RA</span></a> <a class="idref" href="coqrel.RelDefinitions.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#RB"><span class="id" type="variable">RB</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y"><span class="id" type="variable">y</span></a>).<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="coqrel.RelDefinitions.html#arrow_rel"><span class="id" type="definition">arrow_rel</span></a> {<span class="id" type="var">A1</span>%<span class="id" type="var">type</span> <span class="id" type="var">A2</span>%<span class="id" type="var">type</span> <span class="id" type="var">B1</span>%<span class="id" type="var">type</span> <span class="id" type="var">B2</span>%<span class="id" type="var">type</span>} <span class="id" type="var">RA</span>%<span class="id" type="var">rel</span> <span class="id" type="var">RB</span>%<span class="id" type="var">rel</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name=":rel_scope:x_'==>'_x"><span class="id" type="notation">"</span></a>RA ==&gt; RB" := (<a class="idref" href="coqrel.RelDefinitions.html#arrow_rel"><span class="id" type="definition">arrow_rel</span></a> <span class="id" type="var">RA</span> <span class="id" type="var">RB</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 55, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>) : <span class="id" type="var">rel_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name=":rel_scope:x_'++>'_x"><span class="id" type="notation">"</span></a>RA ++&gt; RB" := (<a class="idref" href="coqrel.RelDefinitions.html#arrow_rel"><span class="id" type="definition">arrow_rel</span></a> <span class="id" type="var">RA</span> <span class="id" type="var">RB</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 55, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>) : <span class="id" type="var">rel_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name=":rel_scope:x_'-->'_x"><span class="id" type="notation">"</span></a>RA --&gt; RB" := (<a class="idref" href="coqrel.RelDefinitions.html#arrow_rel"><span class="id" type="definition">arrow_rel</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#flip"><span class="id" type="definition">flip</span></a> <span class="id" type="var">RA</span>) <span class="id" type="var">RB</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 55, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>) : <span class="id" type="var">rel_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="arrow_subrel"><span class="id" type="instance">arrow_subrel</span></a> {<span class="id" type="var">A1</span> <span class="id" type="var">A2</span> <span class="id" type="var">B1</span> <span class="id" type="var">B2</span>}:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#Proper"><span class="id" type="abbreviation">Proper</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#:rel_scope:x_'-->'_x"><span class="id" type="notation">--&gt;</span></a> <a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#:rel_scope:x_'++>'_x"><span class="id" type="notation">++&gt;</span></a> <a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a>) (@<a class="idref" href="coqrel.RelDefinitions.html#arrow_rel"><span class="id" type="definition">arrow_rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A2"><span class="id" type="variable">A2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B1"><span class="id" type="variable">B1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B2"><span class="id" type="variable">B2</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="arrow_subrel_params"><span class="id" type="instance">arrow_subrel_params</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.Morphisms.html#Params"><span class="id" type="class">Params</span></a> (@<a class="idref" href="coqrel.RelDefinitions.html#arrow_rel"><span class="id" type="definition">arrow_rel</span></a>) 4.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="arrow_rintro"><span class="id" type="instance">arrow_rintro</span></a> {<span class="id" type="var">A1</span> <span class="id" type="var">A2</span> <span class="id" type="var">B1</span> <span class="id" type="var">B2</span>} (<span class="id" type="var">RA</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A1"><span class="id" type="variable">A1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A2"><span class="id" type="variable">A2</span></a>) (<span class="id" type="var">RB</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B1"><span class="id" type="variable">B1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B2"><span class="id" type="variable">B2</span></a>) <span class="id" type="var">f</span> <span class="id" type="var">g</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RIntro"><span class="id" type="class">RIntro</span></a> (<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="coqrel.RelDefinitions.html#RA"><span class="id" type="variable">RA</span></a> <a class="idref" href="coqrel.RelDefinitions.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#RB"><span class="id" type="variable">RB</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="coqrel.RelDefinitions.html#y"><span class="id" type="variable">y</span></a>)) (<a class="idref" href="coqrel.RelDefinitions.html#RA"><span class="id" type="variable">RA</span></a> <a class="idref" href="coqrel.RelDefinitions.html#:rel_scope:x_'++>'_x"><span class="id" type="notation">++&gt;</span></a> <a class="idref" href="coqrel.RelDefinitions.html#RB"><span class="id" type="variable">RB</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="arrow_relim"><span class="id" type="lemma">arrow_relim</span></a> {<span class="id" type="var">A1</span> <span class="id" type="var">A2</span> <span class="id" type="var">B1</span> <span class="id" type="var">B2</span>} <span class="id" type="var">RA</span> <span class="id" type="var">RB</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span>:<br/>
&nbsp;&nbsp;@<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B1"><span class="id" type="variable">B1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B2"><span class="id" type="variable">B2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#RB"><span class="id" type="variable">RB</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a> →<br/>
&nbsp;&nbsp;@<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#A1"><span class="id" type="variable">A1</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#B1"><span class="id" type="variable">B1</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#A2"><span class="id" type="variable">A2</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#B2"><span class="id" type="variable">B2</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#RA"><span class="id" type="variable">RA</span></a> <a class="idref" href="coqrel.RelDefinitions.html#:rel_scope:x_'++>'_x"><span class="id" type="notation">++&gt;</span></a> <a class="idref" href="coqrel.RelDefinitions.html#RB"><span class="id" type="variable">RB</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#RA"><span class="id" type="variable">RA</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 1 (<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> (<span class="id" type="var">_</span> <a class="idref" href="coqrel.RelDefinitions.html#:rel_scope:x_'++>'_x"><span class="id" type="notation">++&gt;</span></a> <span class="id" type="var">_</span>) <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="coqrel.RelDefinitions.html#arrow_relim"><span class="id" type="lemma">arrow_relim</span></a> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab58"></a><h3 class="section">Dependent products</h3>

<div class="paragraph"> </div>

 Now we consider the dependent case. The definition of <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a></span>
  is somewhat involved, but you can think of relating <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span> in
  the context of a structure-preserving transformation from a quiver
  (<span class="inlinecode"><a class="idref" href="coqrel.Relators.html#V"><span class="id" type="variable">V</span></a></span>, <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#E"><span class="id" type="variable">E</span></a></span>) to the quiver (<span class="inlinecode"><span class="id" type="keyword">Type</span></span>, <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span>). Like a functor, it has two
  components: <span class="inlinecode"><span class="id" type="var">FV</span></span> maps nodes to types, and <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#FE"><span class="id" type="variable">FE</span></a></span> maps edges to
  relations. Then, <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#FE"><span class="id" type="variable">FE</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span> states that given an edge
  <span class="inlinecode">(<a class="idref" href="coqrel.RelDefinitions.html#e"><span class="id" type="variable">e</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#E"><span class="id" type="variable">E</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v1"><span class="id" type="variable">v1</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v2"><span class="id" type="variable">v2</span></a>)</span>, the images <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v1"><span class="id" type="variable">v1</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v2"><span class="id" type="variable">v2</span></a></span> are related by the
  corresponding relation <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#FE"><span class="id" type="variable">FE</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v1"><span class="id" type="variable">v1</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v2"><span class="id" type="variable">v2</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#e"><span class="id" type="variable">e</span></a></span>. We will write <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#FE"><span class="id" type="variable">FE</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span>
  as <span class="inlinecode">(∀</span> <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#e"><span class="id" type="variable">e</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#E"><span class="id" type="variable">E</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v1"><span class="id" type="variable">v1</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v2"><span class="id" type="variable">v2</span></a>,</span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#FE"><span class="id" type="variable">FE</span></a>[<a class="idref" href="coqrel.Relators.html#v1"><span class="id" type="variable">v1</span></a>,<a class="idref" href="coqrel.Relators.html#v2"><span class="id" type="variable">v2</span></a>,<a class="idref" href="coqrel.RelDefinitions.html#e"><span class="id" type="variable">e</span></a>])</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#g"><span class="id" type="variable">g</span></a></span>. Notice that this notation
  binds <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v1"><span class="id" type="variable">v1</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#v2"><span class="id" type="variable">v2</span></a></span> as well as <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#e"><span class="id" type="variable">e</span></a></span>.

<div class="paragraph"> </div>

  If that makes no sense, you can think of specific source quivers. So
  for instance, oftentimes we will want to use (<span class="inlinecode"><span class="id" type="keyword">Type</span></span>, <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span>) as the
  source quiver too. This corresponds to parametric polymorphism. The
  type of <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a></span> is <span class="inlinecode">∀</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="keyword">Type</span>,</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A"><span class="id" type="variable">A</span></a></span>; the corresponding
  logical relation is <span class="inlinecode">∀</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A1"><span class="id" type="variable">A1</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A2"><span class="id" type="variable">A2</span></a>,</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode">++&gt;</span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#option_rel"><span class="id" type="inductive">option_rel</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span>. Stating
  that <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#Proper"><span class="id" type="abbreviation">Proper</span></a></span> <span class="inlinecode">(∀</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A1"><span class="id" type="variable">A1</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#A2"><span class="id" type="variable">A2</span></a>,</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode">++&gt;</span> <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#option_rel"><span class="id" type="inductive">option_rel</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a>)</span> <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a></span> means that,
  given any relation <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> and elements <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x1"><span class="id" type="variable">x1</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x2"><span class="id" type="variable">x2</span></a></span>, if <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> relates
  <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x1"><span class="id" type="variable">x1</span></a></span> and <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x2"><span class="id" type="variable">x2</span></a></span>, then <span class="inlinecode"><a class="idref" href="coqrel.Relators.html#option_rel"><span class="id" type="inductive">option_rel</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> will relate <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x1"><span class="id" type="variable">x1</span></a></span> and <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#x2"><span class="id" type="variable">x2</span></a></span>.

<div class="paragraph"> </div>

  Another example from <span class="inlinecode"><span class="id" type="var">liblayers</span></span> is the quiver of our data-indexed
  simulation relations <span class="inlinecode"><span class="id" type="var">simrel</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">layerdata</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="var">layerdata</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="keyword">Type</span></span>.
  Here the structure-preserving transformations are our simulation
  relation diagrams, which have types such as
  <span class="inlinecode"><span class="id" type="var">lsim</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="keyword">∀</span></span> <span class="inlinecode"><span class="id" type="var">D1</span></span> <span class="inlinecode"><span class="id" type="var">D2</span>,</span> <span class="inlinecode"><span class="id" type="var">simrel</span></span> <span class="inlinecode"><span class="id" type="var">D1</span></span> <span class="inlinecode"><span class="id" type="var">D2</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span> <span class="inlinecode">(<span class="id" type="var">layer</span></span> <span class="inlinecode"><span class="id" type="var">D1</span>)</span> <span class="inlinecode">(<span class="id" type="var">layer</span></span> <span class="inlinecode"><span class="id" type="var">D2</span>)</span> or
  <span class="inlinecode"><span class="id" type="var">psim</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="keyword">∀</span></span> <span class="inlinecode">{<span class="id" type="var">D1</span></span> <span class="inlinecode"><span class="id" type="var">D2</span>},</span> <span class="inlinecode"><span class="id" type="var">simrel</span></span> <span class="inlinecode"><span class="id" type="var">D1</span></span> <span class="inlinecode"><span class="id" type="var">D2</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a></span> <span class="inlinecode">(<span class="id" type="var">primsem</span></span> <span class="inlinecode"><span class="id" type="var">D1</span>)</span> <span class="inlinecode">(<span class="id" type="var">primsem</span></span> <span class="inlinecode"><span class="id" type="var">D2</span>)</span>.
  Then, the monotonicity of a data-indexed function —
  say, <span class="inlinecode"><span class="id" type="var">foo</span>:</span> <span class="inlinecode"><span class="id" type="keyword">∀</span></span> <span class="inlinecode"><a class="idref" href="coqrel.RelOperators.html#D"><span class="id" type="variable">D</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">layerdata</span>,</span> <span class="inlinecode"><span class="id" type="var">layer</span></span> <span class="inlinecode"><a class="idref" href="coqrel.RelOperators.html#D"><span class="id" type="variable">D</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" type="var">primsem</span></span> <span class="inlinecode"><a class="idref" href="coqrel.RelOperators.html#D"><span class="id" type="variable">D</span></a></span> —
  can be expressed as
  <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#Proper"><span class="id" type="abbreviation">Proper</span></a></span> <span class="inlinecode">(∀</span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" type="var">simrel</span></span> <span class="inlinecode"><span class="id" type="var">D1</span></span> <span class="inlinecode"><span class="id" type="var">D2</span>,</span> <span class="inlinecode"><span class="id" type="var">siml</span></span> <span class="inlinecode"><span class="id" type="var">D1</span></span> <span class="inlinecode"><span class="id" type="var">D2</span></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a></span> <span class="inlinecode">++&gt;</span> <span class="inlinecode"><span class="id" type="var">simp</span></span> <span class="inlinecode"><span class="id" type="var">D1</span></span> <span class="inlinecode"><span class="id" type="var">D2</span></span> <span class="inlinecode"><a class="idref" href="coqrel.LogicalRelationsTests.html#R"><span class="id" type="variable">R</span></a>)</span> <span class="inlinecode"><span class="id" type="var">foo</span></span>.

<div class="paragraph"> </div>

  This definition is the same as <span class="inlinecode"><span class="id" type="var">respectful_hetero</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="forall_rel"><span class="id" type="definition">forall_rel</span></a> {<span class="id" type="var">V1</span> <span class="id" type="var">V2</span>} {<span class="id" type="var">E</span>: <a class="idref" href="coqrel.RelDefinitions.html#V1"><span class="id" type="variable">V1</span></a>→<a class="idref" href="coqrel.RelDefinitions.html#V2"><span class="id" type="variable">V2</span></a>→<span class="id" type="keyword">Type</span>} {<span class="id" type="var">FV1</span>: <a class="idref" href="coqrel.RelDefinitions.html#V1"><span class="id" type="variable">V1</span></a>→<span class="id" type="keyword">Type</span>} {<span class="id" type="var">FV2</span>: <a class="idref" href="coqrel.RelDefinitions.html#V2"><span class="id" type="variable">V2</span></a>→<span class="id" type="keyword">Type</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span>, <a class="idref" href="coqrel.RelDefinitions.html#E"><span class="id" type="variable">E</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v2"><span class="id" type="variable">v2</span></a> → <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#FV1"><span class="id" type="variable">FV1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v1"><span class="id" type="variable">v1</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#FV2"><span class="id" type="variable">FV2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v2"><span class="id" type="variable">v2</span></a>)) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> (<span class="id" type="keyword">∀</span> <span class="id" type="var">v1</span>, <a class="idref" href="coqrel.RelDefinitions.html#FV1"><span class="id" type="variable">FV1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v1"><span class="id" type="variable">v1</span></a>) (<span class="id" type="keyword">∀</span> <span class="id" type="var">v2</span>, <a class="idref" href="coqrel.RelDefinitions.html#FV2"><span class="id" type="variable">FV2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v2"><span class="id" type="variable">v2</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">FE</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span> (<span class="id" type="var">e</span>: <a class="idref" href="coqrel.RelDefinitions.html#E"><span class="id" type="variable">E</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v2"><span class="id" type="variable">v2</span></a>), <a class="idref" href="coqrel.RelDefinitions.html#FE"><span class="id" type="variable">FE</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v2"><span class="id" type="variable">v2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#e"><span class="id" type="variable">e</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v1"><span class="id" type="variable">v1</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v2"><span class="id" type="variable">v2</span></a>).<br/>

<br/>
<span class="id" type="var">Arguments</span> <a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a> {<span class="id" type="var">V1</span>%<span class="id" type="var">type</span> <span class="id" type="var">V2</span>%<span class="id" type="var">type</span> <span class="id" type="var">E</span>%<span class="id" type="var">type</span> <span class="id" type="var">FV1</span>%<span class="id" type="var">type</span> <span class="id" type="var">FV2</span>%<span class="id" type="var">type</span>} <span class="id" type="var">FE</span>%<span class="id" type="var">rel</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name=":rel_scope:'forallr'_x_'@'_x_x_':'_x_','_x"><span class="id" type="notation">"</span></a>'forallr' e @ v1 v2 : E , R" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a> (<span class="id" type="var">E</span> := <span class="id" type="var">E</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span> <span class="id" type="var">e</span> ⇒ <span class="id" type="var">R</span>))<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 200, <span class="id" type="var">e</span> <span class="id" type="var">ident</span>, <span class="id" type="var">v1</span> <span class="id" type="var">ident</span>, <span class="id" type="var">v2</span> <span class="id" type="var">ident</span>, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>) : <span class="id" type="var">rel_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name=":rel_scope:'forallr'_x_'@'_x_x_','_x"><span class="id" type="notation">"</span></a>'forallr' e @ v1 v2 , R" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span> <span class="id" type="var">e</span> ⇒ <span class="id" type="var">R</span>))<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 200, <span class="id" type="var">e</span> <span class="id" type="var">ident</span>, <span class="id" type="var">v1</span> <span class="id" type="var">ident</span>, <span class="id" type="var">v2</span> <span class="id" type="var">ident</span>, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>) : <span class="id" type="var">rel_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name=":rel_scope:'forallr'_x_':'_x_','_x"><span class="id" type="notation">"</span></a>'forallr' e : E , R" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a> (<span class="id" type="var">E</span> := <span class="id" type="var">E</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">e</span> ⇒ <span class="id" type="var">R</span>))<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 200, <span class="id" type="var">e</span> <span class="id" type="var">ident</span>, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>) : <span class="id" type="var">rel_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name=":rel_scope:'forallr'_x_','_x"><span class="id" type="notation">"</span></a>'forallr' e , R" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">e</span> ⇒ <span class="id" type="var">R</span>))<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 200, <span class="id" type="var">e</span> <span class="id" type="var">ident</span>, <span class="id" type="tactic">right</span> <span class="id" type="keyword">associativity</span>) : <span class="id" type="var">rel_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="forall_rintro"><span class="id" type="instance">forall_rintro</span></a> {<span class="id" type="var">V1</span> <span class="id" type="var">V2</span> <span class="id" type="var">E</span> <span class="id" type="var">F1</span> <span class="id" type="var">F2</span>} (<span class="id" type="var">FE</span>: <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <span class="id" type="var">_</span> → <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) <span class="id" type="var">f</span> <span class="id" type="var">g</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RIntro"><span class="id" type="class">RIntro</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span> <span class="id" type="var">e</span>, <a class="idref" href="coqrel.RelDefinitions.html#FE"><span class="id" type="variable">FE</span></a> <a class="idref" href="coqrel.RelDefinitions.html#u"><span class="id" type="variable">u</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v"><span class="id" type="variable">v</span></a> <a class="idref" href="coqrel.RelDefinitions.html#e"><span class="id" type="variable">e</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#u"><span class="id" type="variable">u</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v"><span class="id" type="variable">v</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#V1"><span class="id" type="variable">V1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#V2"><span class="id" type="variable">V2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#E"><span class="id" type="variable">E</span></a> <a class="idref" href="coqrel.RelDefinitions.html#F1"><span class="id" type="variable">F1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#F2"><span class="id" type="variable">F2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#FE"><span class="id" type="variable">FE</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="forall_relim"><span class="id" type="lemma">forall_relim</span></a> {<span class="id" type="var">V1</span> <span class="id" type="var">V2</span> <span class="id" type="var">E</span> <span class="id" type="var">FV1</span> <span class="id" type="var">FV2</span>} <span class="id" type="var">R</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span> <span class="id" type="var">e</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v2"><span class="id" type="variable">v2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#e"><span class="id" type="variable">e</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v1"><span class="id" type="variable">v1</span></a>) (<a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="coqrel.RelDefinitions.html#v2"><span class="id" type="variable">v2</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> (@<a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#V1"><span class="id" type="variable">V1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#V2"><span class="id" type="variable">V2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#E"><span class="id" type="variable">E</span></a> <a class="idref" href="coqrel.RelDefinitions.html#FV1"><span class="id" type="variable">FV1</span></a> <a class="idref" href="coqrel.RelDefinitions.html#FV2"><span class="id" type="variable">FV2</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="coqrel.RelDefinitions.html#g"><span class="id" type="variable">g</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 1 (<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#forall_rel"><span class="id" type="definition">forall_rel</span></a> <span class="id" type="var">_</span>) <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="coqrel.RelDefinitions.html#forall_relim"><span class="id" type="lemma">forall_relim</span></a> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab59"></a><h2 class="section">Inverse relation</h2>

<div class="paragraph"> </div>

 We use <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#flip"><span class="id" type="definition">flip</span></a></span> as our inversion relator. To this end we
  characterize its variance and introduce an <span class="inlinecode"><a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="record">RElim</span></a></span> rule. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="flip_subrel"><span class="id" type="instance">flip_subrel</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>}:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#Proper"><span class="id" type="abbreviation">Proper</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#:rel_scope:x_'++>'_x"><span class="id" type="notation">++&gt;</span></a> <a class="idref" href="coqrel.RelDefinitions.html#subrel"><span class="id" type="definition">subrel</span></a>) (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#flip"><span class="id" type="definition">flip</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a> <span class="id" type="keyword">Prop</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Global Instance</span> <a name="flip_subrel_params"><span class="id" type="instance">flip_subrel_params</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.Morphisms.html#Params"><span class="id" type="class">Params</span></a> (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#flip"><span class="id" type="definition">flip</span></a>) 3.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="flip_rintro"><span class="id" type="lemma">flip_rintro</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) <span class="id" type="var">m</span> <span class="id" type="var">n</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RIntro"><span class="id" type="class">RIntro</span></a> (<a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#flip"><span class="id" type="definition">flip</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 1 (<a class="idref" href="coqrel.RelDefinitions.html#RIntro"><span class="id" type="class">RIntro</span></a> <span class="id" type="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#flip"><span class="id" type="definition">flip</span></a> <span class="id" type="var">_</span>) <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="coqrel.RelDefinitions.html#flip_rintro"><span class="id" type="lemma">flip_rintro</span></a> : <span class="id" type="var">typeclass_instances</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="flip_relim"><span class="id" type="lemma">flip_relim</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">R</span>: <a class="idref" href="coqrel.RelDefinitions.html#rel"><span class="id" type="abbreviation">rel</span></a> <a class="idref" href="coqrel.RelDefinitions.html#A"><span class="id" type="variable">A</span></a> <a class="idref" href="coqrel.RelDefinitions.html#B"><span class="id" type="variable">B</span></a>) <span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="var">P</span> <span class="id" type="var">Q</span>:<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#flip"><span class="id" type="definition">flip</span></a> <a class="idref" href="coqrel.RelDefinitions.html#R"><span class="id" type="variable">R</span></a>) <a class="idref" href="coqrel.RelDefinitions.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="coqrel.RelDefinitions.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="coqrel.RelDefinitions.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="coqrel.RelDefinitions.html#Q"><span class="id" type="variable">Q</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">firstorder</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 1 (<a class="idref" href="coqrel.RelDefinitions.html#RElim"><span class="id" type="class">RElim</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Basics.html#flip"><span class="id" type="definition">flip</span></a> <span class="id" type="var">_</span>) <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ⇒<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="coqrel.RelDefinitions.html#flip_relim"><span class="id" type="lemma">flip_relim</span></a> : <span class="id" type="var">typeclass_instances</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>